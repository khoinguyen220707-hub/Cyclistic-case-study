CREATE OR REPLACE TABLE `first-case-study-485421.cyclistic_tripdata_2025.trips_2025_User_frequency` AS
(
SELECT
  EXTRACT(MONTH FROM started_at ) AS Month,
  member_casual,
  ROUND(MAX(TIMESTAMP_DIFF(ended_at, started_at, SECOND)/60), 2) AS max_length,
  ROUND(MIN(TIMESTAMP_DIFF(ended_at, started_at, SECOND)/60), 2) AS min_length,
  ROUND(AVG(TIMESTAMP_DIFF(ended_at, started_at, SECOND)/60), 2) AS mean_length,
  ROUND(SUM(TIMESTAMP_DIFF(ended_at, started_at, SECOND)/60), 2) AS total_length
FROM `first-case-study-485421.cyclistic_tripdata_2025.trips_2025_cleaned`
GROUP BY month, member_casual
ORDER BY month
