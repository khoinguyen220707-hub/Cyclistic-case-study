CREATE OR REPLACE TABLE `first-case-study-485421.cyclistic_tripdata_2025.trips_2025_Time_Period` AS
(
SELECT
  (CASE
    WHEN EXTRACT(HOUR FROM started_at) BETWEEN 5 AND 11 THEN 'Morning'
    WHEN EXTRACT(HOUR FROM started_at) BETWEEN 12 AND 16 THEN 'Afternoon'
    WHEN EXTRACT(HOUR FROM started_at) BETWEEN 17 AND 22 THEN 'Evening'
    ELSE 'Late Night'
  END) AS Period,
  rideable_type,
  member_casual,
  COUNT(*) AS total_rides
FROM `first-case-study-485421.cyclistic_tripdata_2025.trips_2025_cleaned`
GROUP BY Period,member_casual,rideable_type
ORDER BY Period DESC
)
